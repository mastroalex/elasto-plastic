/*************************************************************
* AceGen    7.303 MacOSX (3 Aug 21)                          *
*           Co. J. Korelc  2020           22 Dec 21 09:35:36 *
**************************************************************
User     : Full professional version
Notebook : EP_ACM_2021 2
Evaluation time                 : 14 s    Mode  : Optimal
Number of formulae              : 606     Method: Automatic
Subroutine                      : SKR size: 5250
Subroutine                      : SPP size: 4108
Total size of Mathematica  code : 9358 subexpressions
Total size of C code            : 25307 bytes */
#include "sms.h"

void SKR(double v[1347],ElementSpec *es,ElementData *ed,NodeSpec **ns,NodeData **nd,double *rdata,int *idata,double *p,double **s);
void SPP(double v[1347],ElementSpec *es,ElementData *ed,NodeSpec **ns,NodeData **nd,double *rdata,int *idata,double **gpost,double **npost);

int MMAInitialisationCode[]={
0,24,123,72,111,108,100,91,78,117,108,108,93,44,32,72,111,108,100,91,78,117,108,108,93,125
};



DLLEXPORT int SMTSetElSpec(ElementSpec *es,int *idata,int ic,int ng)
{ int intc,nd,i;FILE *SMSFile;
  static int pn[11]={1, 2, 3, 4, 0, 1, 2, 3, 4, -1, 0};
  static int dof[4]={2, 2, 2, 2};
  static int nsto[4]={0, 0, 0, 0};

  static int ndat[4]={0, 0, 0, 0};

  static int esdat[1]={0};

  static char *nid[]={"D","D","D","D"};
  static char *gdcs[]={"E -Young","$[Nu]$ -Poisson","$[Sigma]$YO -yield","H -Hardening"};
  static double defd[]={100e0,0.49e0,1e0,10e0,0e0};
  static char *gpcs[]={"$[Epsilon]$xx","$[Epsilon]$xy","$[Epsilon]$yy","$[Epsilon]$exx","$[Epsilon]$exy","$[Epsilon]$eyy",
                       "$[Epsilon]$pxx","$[Epsilon]$pxy","$[Epsilon]$pyy","$[Sigma]$xx","$[Sigma]$xy","$[Sigma]$yy",
                       "$[Sigma]$VM","$[Alpha]$","$[Lambda]$","$[CapitalPsi]$e"};
  static char *npcs[]={"DeformedMeshX","DeformedMeshY","u","v"};
  static char *sname[]={""};
  static char *idname[]={""};
  static int idindex[1];
  static char *rdname[]={""};
  static char *cswitch[]={""};
  static int iswitch[1]={0};
  static double dswitch[1]={0e0};
  static int rdindex[1];
  static int nspecs[4];
  static double version[3]={7.303,7.303,12.3};
  static double pnweights[4]={1e0,1e0,1e0,1e0};
  static double rnodes[12]={-1e0,-1e0,0e0,1e0,-1e0,0e0,
  1e0,1e0,0e0,-1e0,1e0,0e0};
  es->ReferenceNodes=rnodes;
  if(ng==-1) es->Data=defd;
  es->id.NoDomainData=4;
  es->Code="Q1EPS";es->Version=version;
  es->MainTitle="";
  es->SubTitle="";
  es->SubSubTitle="";
  es->Bibliography="";
  es->id.NoDimensions=2;es->id.NoDOFGlobal=8;es->id.NoDOFCondense=0;es->id.NoNodes=4;
  es->id.NoSegmentPoints=10;es->Segments=pn;es->PostNodeWeights=pnweights;
  es->id.NoIntSwitch=0;es->IntSwitch=iswitch;es->id.LocalReKe=0;
  es->id.NoDoubleSwitch=0;es->DoubleSwitch=dswitch;
  es->id.NoCharSwitch=0;es->id.WorkingVectorSize=1347;es->CharSwitch=cswitch;
  es->DOFGlobal=dof;es->NodeID=nid;es->id.NoGPostData=16;es->id.NoNPostData=4;
  es->id.SymmetricTangent=1;es->id.PostIterationCall=1;es->id.DOFScaling=0;
  es->Topology="Q1";es->DomainDataNames=gdcs;es->GPostNames=gpcs;es->NPostNames=npcs;
  es->AdditionalNodes="{} & ";
  es->AdditionalGraphics="{Null,Null,Null}";
  es->MMAInitialisation=MMAInitialisationCode;
  es->MMANextStep="";
  es->MMAStepBack="";
  es->MMAPreIteration="";
  es->IDataNames=idname;es->IDataIndex=idindex;es->RDataNames=rdname;es->RDataIndex=rdindex;
  es->id.NoIData=0;es->id.NoRData=0;
  es->id.ShapeSensitivity=0; es->id.EBCSensitivity=0;es->id.SensitivityOrder=0;
  es->id.NoSensNames=0;es->SensitivityNames=sname;es->NodeSpecs=nspecs;
  es->user.SPP=SPP;es->user.SKR=SKR;

  es->id.DefaultIntegrationCode=2;
  if(ic==-1){intc=2;} else {intc=ic;};
  es->id.IntCode=intc;
  SMTMultiIntPoints(&intc,idata,&es->id.NoIntPoints,
      &es->id.NoIntPointsA,&es->id.NoIntPointsB,&es->id.NoIntPointsC,0);
  es->id.NoAdditionalData=(int)(0);
  es->id.NoTimeStorage=(int)((int)(8*es->id.NoIntPoints));
  es->id.NoElementData=(int)(0);


  es->NoNodeStorage=nsto;es->NoNodeData=ndat;
  
  es->ExtraSensitivityData=esdat;
  if(1){
   return 0;
  }else{
   return 1;
  };
};


/******************* S U B R O U T I N E *********************/
void SKR(double v[1347],ElementSpec *es,ElementData *ed,NodeSpec **ns
     ,NodeData **nd,double *rdata,int *idata,double *p,double **s)
{
int i1,i2,i8,i76,i78,i130,i131,i132,i133,i134,i135,i136,i137,i146,i436,i452
     ,b121,b122,b355,b424,b449,b466;
i78=idata[ID_Iteration];
v[77]=rdata[RD_SubIterationTolerance];
v[27]=nd[3]->at[1];
v[26]=nd[3]->at[0];
v[25]=nd[2]->at[1];
v[24]=nd[2]->at[0];
v[23]=nd[1]->at[1];
v[22]=nd[1]->at[0];
v[21]=nd[0]->at[1];
v[20]=nd[0]->at[0];
v[19]=nd[3]->X[1];
v[18]=nd[3]->X[0];
v[17]=nd[2]->X[1];
v[964]=v[17]-v[19];
v[16]=nd[2]->X[0];
v[966]=v[16]-v[18];
v[15]=nd[1]->X[1];
v[960]=v[15]-v[17];
v[14]=nd[1]->X[0];
v[962]=v[14]-v[16];
v[13]=nd[0]->X[1];
v[963]=v[13]-v[15];
v[959]=v[13]-v[19];
v[12]=nd[0]->X[0];
v[965]=v[12]-v[14];
v[961]=v[12]-v[18];
v[6]=es->Data[3];
v[5]=es->Data[2];
v[4]=es->Data[1];
v[103]=es->Data[0]/(2e0*(1e0+v[4]));
v[936]=2e0*v[103];
v[101]=(v[4]*v[936])/(1e0-2e0*v[4]);
i1=es->id.NoIntPoints;
for(i2=1;i2<=i1;i2++){
 i8=4*(-1+i2);
 v[7]=es->IntPoints[i8];
 v[39]=(-1e0+v[7])/4e0;
 v[40]=(-1e0-v[7])/4e0;
 v[45]=v[39]*v[959]+v[40]*v[960];
 v[43]=v[39]*v[961]+v[40]*v[962];
 v[9]=es->IntPoints[1+i8];
 v[41]=(1e0+v[9])/4e0;
 v[38]=(-1e0+v[9])/4e0;
 v[44]=v[38]*v[963]+v[41]*v[964];
 v[42]=v[38]*v[965]+v[41]*v[966];
 v[46]=-(v[43]*v[44])+v[42]*v[45];
 v[957]=es->IntPoints[3+i8]*v[46];
 v[49]=-(v[45]/v[46]);
 v[63]=-(v[41]*v[49]);
 v[55]=-(v[38]*v[49]);
 v[50]=v[43]/v[46];
 v[66]=-(v[41]*v[50]);
 v[57]=-(v[38]*v[50]);
 v[51]=-(v[44]/v[46]);
 v[64]=v[39]*v[51];
 v[59]=v[40]*v[51];
 v[52]=v[42]/v[46];
 v[67]=v[39]*v[52];
 v[61]=v[40]*v[52];
 v[53]=v[55]+v[64];
 v[54]=v[57]+v[67];
 v[56]=-v[55]+v[59];
 v[58]=-v[57]+v[61];
 v[60]=-v[59]+v[63];
 v[62]=-v[61]+v[66];
 v[65]=-v[63]-v[64];
 v[1224]=v[53];
 v[1225]=0e0;
 v[1226]=v[56];
 v[1227]=0e0;
 v[1228]=v[60];
 v[1229]=0e0;
 v[1230]=v[65];
 v[1231]=0e0;
 v[68]=-v[66]-v[67];
 v[1232]=0e0;
 v[1233]=v[54];
 v[1234]=0e0;
 v[1235]=v[58];
 v[1236]=0e0;
 v[1237]=v[62];
 v[1238]=0e0;
 v[1239]=v[68];
 v[1204]=v[54];
 v[1205]=v[53];
 v[1206]=v[58];
 v[1207]=v[56];
 v[1208]=v[62];
 v[1209]=v[60];
 v[1210]=v[68];
 v[1211]=v[65];
 v[73]=v[20]*v[53]+v[22]*v[56]+v[24]*v[60]+v[26]*v[65];
 v[74]=(v[21]*v[53]+v[20]*v[54]+v[23]*v[56]+v[22]*v[58]+v[25]*v[60]+v[24]*v[62]+v[27]*v[65]
  +v[26]*v[68])/2e0;
 v[75]=v[21]*v[54]+v[23]*v[58]+v[25]*v[62]+v[27]*v[68];
 i76=8*(-1+i2);
 i137=8+i76;
 i136=7+i76;
 i135=6+i76;
 i134=5+i76;
 i133=4+i76;
 i132=3+i76;
 i131=2+i76;
 i130=1+i76;
 v[86]=ed->hp[i130-1];
 v[87]=ed->hp[i131-1];
 v[88]=ed->hp[i132-1];
 v[89]=ed->hp[i133-1];
 v[90]=ed->hp[i134-1];
 v[91]=ed->hp[i135-1];
 v[92]=ed->hp[i136-1];
 v[98]=v[73]-v[86];
 v[100]=v[75]-v[87];
 v[108]=v[101]*(v[100]+v[98]);
 v[110]=v[108]+v[936]*v[98];
 v[112]=v[108]+v[100]*v[936];
 v[119]=(-v[110]-v[112])/3e0;
 b121=(i78==1 && ed->hp[i137-1]==0e0) || (i78>1 && (-v[5]+sqrt(0.15e1*(Power(v[110]+v[119]
  +v[6]*v[89],2)+Power(v[112]+v[119]+v[6]*v[90],2)+2e0*Power(v[6]*v[91]+(v[74]-v[88])*v[936],2)))
  )<v[77]);
 if(b121){
  v[123]=v[86];
  v[124]=v[87];
  v[125]=v[88];
  v[126]=v[89];
  v[127]=v[90];
  v[128]=v[91];
  v[129]=v[92];
  ed->ht[i130-1]=v[123];
  ed->ht[i131-1]=v[124];
  ed->ht[i132-1]=v[125];
  ed->ht[i133-1]=v[126];
  ed->ht[i134-1]=v[127];
  ed->ht[i135-1]=v[128];
  ed->ht[i136-1]=v[129];
  ed->ht[i137-1]=0e0;
 } else {
  v[192]=2e0*v[6];
  v[194]=-v[101]-v[936];
  v[196]=(v[101]-v[194])/3e0;
  v[198]=v[194]+v[196];
  v[197]=-v[101]+v[196];
  v[359]=(2e0/3e0)*(2e0*v[197]-v[198]);
  v[358]=(-2e0/3e0)*(v[197]-2e0*v[198]);
  v[139]=v[86];
  v[140]=v[87];
  v[141]=v[88];
  v[142]=v[89];
  v[143]=v[90];
  v[144]=v[91];
  v[145]=v[92];
  for(i146=1;i146<=30;i146++){
   v[185]=v[145]-v[92];
   v[939]=-0.5e0*v[185];
   v[150]=-v[139]+v[73];
   v[152]=-v[140]+v[75];
   v[159]=v[101]*(v[150]+v[152]);
   v[161]=v[159]+v[150]*v[936];
   v[163]=v[159]+v[152]*v[936];
   v[177]=v[144]*v[6]+(-v[141]+v[74])*v[936];
   v[204]=(v[177]*v[177]);
   v[170]=(-v[161]-v[163])/3e0;
   v[174]=v[163]+v[170]+v[143]*v[6];
   v[947]=-0.15e1*v[174];
   v[173]=v[161]+v[170]+v[142]*v[6];
   v[946]=-0.15e1*v[173];
   v[948]=(2e0*v[173]-v[174])/2e0;
   v[943]=-(v[185]*v[948]);
   v[240]=(-2e0/3e0)*(v[173]-2e0*v[174]);
   v[949]=0.75e0*v[240];
   v[950]=-(v[185]*v[949]);
   v[214]=2e0*(v[173]*v[197]+v[174]*v[198]);
   v[211]=2e0*(v[174]*v[197]+v[173]*v[198]);
   v[200]=(v[173]*v[173])+(v[174]*v[174])+2e0*v[204];
   v[952]=sqrt(0.15e1*v[200]);
   v[942]=3e0/v[952];
   v[937]=-(1e0/(v[200]*v[952]));
   v[218]=v[6]*v[937];
   v[219]=v[174]*v[218];
   v[217]=v[173]*v[218];
   v[213]=v[937]/2e0;
   v[215]=v[213]*v[214];
   v[212]=v[211]*v[213];
   v[938]=v[939]*(6e0*v[204]*v[937]+v[942]);
   v[252]=v[6]*v[938];
   v[249]=-(v[936]*v[938]);
   v[202]=0.15e1*v[177]*v[937];
   v[941]=v[202]*v[939];
   v[940]=v[192]*v[202];
   v[208]=v[174]*v[940];
   v[207]=v[173]*v[940];
   v[248]=v[214]*v[941];
   v[247]=v[211]*v[941];
   v[182]=v[177]*v[942];
   v[220]=((-2e0/3e0)*v[182])/v[200];
   v[221]=v[220]*v[6];
   v[270]=v[221]*v[943];
   v[216]=-(v[220]*v[936]);
   v[951]=v[185]*v[216];
   v[267]=v[216]*v[943];
   v[945]=-0.15e1/v[952];
   v[944]=0.75e0/v[952];
   v[235]=v[214]*v[944];
   v[234]=v[211]*v[944];
   v[232]=v[6]*v[945];
   v[229]=v[197]*v[945];
   v[227]=v[198]*v[945];
   v[278]=-(v[185]*(v[227]+v[212]*v[946]));
   v[284]=-(v[185]*(v[229]+v[212]*v[947]));
   v[183]=v[947]/v[952];
   v[181]=v[946]/v[952];
   v[262]=-0.5e0*v[6]/v[952];
   v[269]=-(v[185]*(v[262]+v[219]*v[948]));
   v[260]=-2e0*v[262];
   v[268]=-(v[185]*(v[260]+v[217]*v[948]));
   v[257]=v[359]*v[944];
   v[266]=-(v[185]*(v[257]+v[215]*v[948]));
   v[254]=v[358]*v[944];
   v[361]=-(v[185]*(v[254]+v[212]*v[948]));
   v[265]=1e0+v[361];
   v[179]=v[240]*v[944];
   v[253]=-0.5e0*v[182];
   v[190]=v[185]*v[253];
   v[175]=v[948]/v[952];
   v[184]=v[139]-v[175]*v[185]-v[86];
   v[290]=-((v[185]*(v[257]+v[212]*v[949]))/v[265]);
   v[291]=1e0-v[266]*v[290]-v[185]*(v[254]+v[215]*v[949]);
   v[292]=-(v[267]*v[290])+v[216]*v[950];
   v[293]=-(v[268]*v[290])-v[185]*(v[262]+v[217]*v[949]);
   v[294]=-(v[269]*v[290])-v[185]*(v[260]+v[219]*v[949]);
   v[295]=-(v[270]*v[290])+v[221]*v[950];
   v[296]=-v[179]+v[175]*v[290];
   v[297]=v[247]/v[265];
   v[392]=-(v[266]*v[297]);
   v[342]=v[184]*v[297];
   v[338]=v[175]*v[297];
   v[335]=-(v[270]*v[297]);
   v[318]=-(v[267]*v[297]);
   v[298]=v[278]/v[265];
   v[953]=-(v[266]*v[298])-v[185]*(v[229]+v[215]*v[946]);
   v[299]=v[284]/v[265];
   v[954]=-(v[266]*v[299])-v[185]*(v[227]+v[215]*v[947]);
   v[300]=v[234]/v[265];
   v[394]=-(v[266]*v[300]);
   v[301]=-v[140]+v[179]*v[185]+v[184]*v[290]+v[87];
   v[302]=(v[248]+v[392])/v[291];
   v[343]=-(v[301]*v[302]);
   v[339]=-(v[296]*v[302]);
   v[336]=-(v[295]*v[302]);
   v[319]=-(v[292]*v[302]);
   v[375]=-v[249]-v[318]-v[319];
   v[303]=1e0+v[249]+v[318]+v[319];
   v[304]=-(v[268]*v[297])-v[293]*v[302]+v[207]*v[939];
   v[305]=-(v[269]*v[297])-v[294]*v[302]+v[208]*v[939];
   v[306]=v[252]+v[335]+v[336];
   v[307]=v[253]+v[338]+v[339];
   v[308]=v[953]/v[291];
   v[309]=v[954]/v[291];
   v[376]=-(v[267]*v[299])-v[292]*v[309]-v[947]*v[951];
   v[310]=(v[235]+v[394])/v[291];
   v[379]=-(v[267]*v[300])-v[292]*v[310]-v[182]*v[936];
   v[311]=-v[141]-v[190]+v[342]+v[343]+v[88];
   v[312]=-((v[267]*v[298]+v[292]*v[308]+v[946]*v[951])/v[303]);
   v[313]=1e0-v[268]*v[298]-v[293]*v[308]-v[304]*v[312]-v[185]*(v[232]+v[217]*v[946]);
   v[314]=-(v[269]*v[298])-v[294]*v[308]-v[305]*v[312]-v[185]*v[217]*v[947];
   v[315]=v[185]*v[207]-v[270]*v[298]-v[295]*v[308]-v[306]*v[312];
   v[316]=-v[181]+v[175]*v[298]-v[296]*v[308]-v[307]*v[312];
   v[317]=v[376]/v[303];
   v[320]=v[375]/v[303];
   v[321]=v[379]/v[303];
   v[322]=-v[142]+v[181]*v[185]+v[184]*v[298]-v[301]*v[308]-v[311]*v[312]+v[89];
   v[323]=v[314]/v[313];
   v[324]=1e0-v[269]*v[299]-v[294]*v[309]-v[305]*v[317]-v[314]*v[323]-v[185]*(v[232]+v[219]*v[947]
    );
   v[325]=v[185]*v[208]-v[270]*v[299]-v[295]*v[309]-v[306]*v[317]-v[315]*v[323];
   v[326]=-v[183]+v[175]*v[299]-v[296]*v[309]-v[307]*v[317]-v[316]*v[323];
   v[329]=-((v[304]+v[304]*v[320])/v[313]);
   v[330]=-((v[173]*v[232]+v[268]*v[300]+v[293]*v[310]+v[304]*v[321])/v[313]);
   v[331]=-v[143]+v[183]*v[185]+v[184]*v[299]-v[301]*v[309]-v[311]*v[317]-v[322]*v[323]+v[90];
   v[334]=-((v[305]+v[305]*v[320]+v[314]*v[329])/v[324]);
   v[337]=1e0-v[252]-v[306]*v[320]-v[315]*v[329]-v[325]*v[334]-v[335]-v[336];
   v[340]=-v[253]-v[307]*v[320]-v[316]*v[329]-v[326]*v[334]-v[338]-v[339];
   v[341]=-((v[174]*v[232]+v[269]*v[300]+v[294]*v[310]+v[305]*v[321]+v[314]*v[330])/v[324]);
   v[344]=-v[144]+v[190]-v[311]*v[320]-v[322]*v[329]-v[331]*v[334]-v[342]-v[343]+v[91];
   v[345]=-((v[270]*v[300]+v[295]*v[310]+v[306]*v[321]+v[315]*v[330]+v[325]*v[341]-v[182]*v[6])
    /v[337]);
   v[346]=v[175]*v[300]-v[296]*v[310]-v[307]*v[321]-v[316]*v[330]-v[326]*v[341]-v[340]*v[345];
   v[347]=-((-(v[184]*v[300])+v[301]*v[310]+v[311]*v[321]+v[322]*v[330]+v[331]*v[341]+v[344]*v[345]
    -v[5]+v[952])/v[346]);
   v[348]=(v[344]-v[340]*v[347])/v[337];
   v[349]=(v[331]-v[326]*v[347]-v[325]*v[348])/v[324];
   v[350]=-((-v[322]+v[316]*v[347]+v[315]*v[348]+v[314]*v[349])/v[313]);
   v[351]=-((-v[311]+v[307]*v[347]+v[306]*v[348]+v[305]*v[349]+v[304]*v[350])/v[303]);
   v[352]=-((-v[301]+v[296]*v[347]+v[295]*v[348]+v[294]*v[349]+v[293]*v[350]+v[292]*v[351])/v[291]
    );
   v[353]=-((v[184]-v[175]*v[347]+v[270]*v[348]+v[269]*v[349]+v[268]*v[350]+v[267]*v[351]
    +v[266]*v[352])/v[265]);
   v[139]=v[139]+v[353];
   v[140]=v[140]+v[352];
   v[141]=v[141]+v[351];
   v[142]=v[142]+v[350];
   v[143]=v[143]+v[349];
   v[144]=v[144]+v[348];
   v[145]=v[145]+v[347];
   if(sqrt((v[347]*v[347])+(v[348]*v[348])+(v[349]*v[349])+(v[350]*v[350])+(v[351]*v[351])+
    (v[352]*v[352])+(v[353]*v[353]))<v[77]){
    v[955]=v[292]-v[295];
    v[367]=-(v[297]*v[361]);
    v[366]=-(v[290]*v[302]);
    ed->ht[i130-1]=v[139];
    ed->ht[i131-1]=v[140];
    ed->ht[i132-1]=v[141];
    ed->ht[i133-1]=v[142];
    ed->ht[i134-1]=v[143];
    ed->ht[i135-1]=v[144];
    ed->ht[i136-1]=v[145];
    ed->ht[i137-1]=1e0;
    v[363]=v[247]+v[366]+v[367];
    v[364]=v[278]-v[290]*v[308]-v[298]*v[361]-v[312]*v[363];
    v[365]=v[284]-v[290]*v[309]-v[299]*v[361]-v[317]*v[363]-v[323]*v[364];
    v[368]=-v[247]-v[320]*v[363]-v[329]*v[364]-v[334]*v[365]-v[366]-v[367];
    v[369]=-((-v[234]+v[290]*v[310]+v[300]*v[361]+v[321]*v[363]+v[330]*v[364]+v[341]*v[365]
     +v[345]*v[368])/v[346]);
    v[370]=(v[368]-v[340]*v[369])/v[337];
    v[371]=(v[365]-v[326]*v[369]-v[325]*v[370])/v[324];
    v[372]=-((-v[364]+v[316]*v[369]+v[315]*v[370]+v[314]*v[371])/v[313]);
    v[373]=(v[290]-v[296]*v[369]-v[294]*v[371]-v[293]*v[372]+v[370]*v[955])/v[291];
    v[377]=-(v[312]*v[323])+v[317]*v[375]+v[376];
    v[378]=v[320]-v[312]*v[329]-v[334]*v[377];
    v[380]=(-(v[312]*v[330])+v[321]*v[375]-v[341]*v[377]-v[345]*v[378]+v[379])/v[346];
    v[381]=(v[378]-v[340]*v[380])/v[337];
    v[956]=1e0+v[381];
    v[382]=(v[377]-v[326]*v[380]-v[325]*v[381])/v[324];
    v[383]=-((-v[312]+v[316]*v[380]+v[315]*v[381]+v[314]*v[382])/v[313]);
    v[384]=-((v[296]*v[380]+v[295]*v[381]+v[294]*v[382]+v[293]*v[383]-v[292]*v[956])/v[291]);
    v[387]=-1e0+v[291];
    v[389]=-(v[302]*v[312])-v[308]*v[387]+v[953];
    v[391]=-(v[302]*v[317])-v[309]*v[387]-v[323]*v[389]+v[954];
    v[393]=-v[248]+v[302]*(-v[320]+v[387])-v[329]*v[389]-v[334]*v[391]-v[392];
    v[395]=-((-v[235]+v[302]*v[321]+v[310]*v[387]+v[330]*v[389]+v[341]*v[391]+v[345]*v[393]-v[394])
     /v[346]);
    v[396]=(v[393]-v[340]*v[395])/v[337];
    v[397]=(v[391]-v[326]*v[395]-v[325]*v[396])/v[324];
    v[398]=-((-v[389]+v[316]*v[395]+v[315]*v[396]+v[314]*v[397])/v[313]);
    v[399]=(v[387]-v[296]*v[395]-v[294]*v[397]-v[293]*v[398]+v[396]*v[955])/v[291];
    v[401]=(v[361]+v[175]*v[369]+(v[267]-v[270])*v[370]-v[269]*v[371]-v[268]*v[372]-v[266]*v[373])
     /v[265];
    v[402]=-((-(v[175]*v[380])+v[270]*v[381]+v[269]*v[382]+v[268]*v[383]+v[266]*v[384]
     -v[267]*v[956])/v[265]);
    v[403]=-((-(v[175]*v[395])-v[267]*v[396]+v[270]*v[396]+v[269]*v[397]+v[268]*v[398]+v[266]*(-1e0
     +v[399]))/v[265]);
    v[404]=v[373];
    v[405]=v[384];
    v[406]=v[399];
    v[407]=-v[370];
    v[408]=-v[381];
    v[409]=-v[396];
    break;
   } else {
   };
   if(i146==29){
    idata[ID_SubDivergence]=1e0;
    idata[ID_ErrorStatus]=2e0;
    break;
   } else {
   };
  };/* end for */
  v[123]=v[139];
  v[124]=v[140];
  v[125]=v[141];
  v[126]=v[142];
  v[127]=v[143];
  v[128]=v[144];
  v[129]=v[145];
 };
 v[430]=-v[123]+v[73];
 v[432]=-v[124]+v[75];
 v[441]=v[101]*(v[430]+v[432]);
 v[439]=v[441]+v[432]*v[936];
 v[440]=4e0*v[103]*(-v[125]+v[74]);
 v[442]=v[441]+v[430]*v[936];
 v[1196]=v[442]*v[53];
 v[1197]=v[439]*v[54];
 v[1198]=v[442]*v[56];
 v[1199]=v[439]*v[58];
 v[1200]=v[442]*v[60];
 v[1201]=v[439]*v[62];
 v[1202]=v[442]*v[65];
 v[1203]=v[439]*v[68];
 b449=b121;
 for(i436=1;i436<=8;i436++){
  v[457]=v[1203+i436];
  v[455]=v[1223+i436]*v[957];
  v[456]=v[1231+i436]*v[957];
  v[458]=v[457]*v[936]*v[957];
  v[461]=v[101]*(v[455]+v[456]);
  v[460]=v[461]+v[456]*v[936];
  v[462]=v[461]+v[455]*v[936];
  v[463]=v[460];
  v[464]=v[458];
  v[465]=v[462];
  b466=b121;
  if(b466){
  } else {
   v[463]=-(v[409]*v[458])-v[406]*v[460]-v[403]*v[462]+v[463];
   v[464]=-(v[408]*v[458])-v[405]*v[460]-v[402]*v[462]+v[464];
   v[465]=-(v[407]*v[458])-v[404]*v[460]-v[401]*v[462]+v[465];
  };
  v[958]=v[464]/2e0;
  v[1240]=v[465]*v[53]+v[54]*v[958];
  v[1241]=v[463]*v[54]+v[53]*v[958];
  v[1242]=v[465]*v[56]+v[58]*v[958];
  v[1243]=v[463]*v[58]+v[56]*v[958];
  v[1244]=v[465]*v[60]+v[62]*v[958];
  v[1245]=v[463]*v[62]+v[60]*v[958];
  v[1246]=v[465]*v[65]+v[68]*v[958];
  v[1247]=v[463]*v[68]+v[65]*v[958];
  p[i436-1]+=(v[1195+i436]+(v[440]*v[457])/2e0)*v[957];
  for(i452=i436;i452<=8;i452++){
   s[i436-1][i452-1]+=v[1239+i452];
  };/* end for */
 };/* end for */
};/* end for */
};

/******************* S U B R O U T I N E *********************/
void SPP(double v[1347],ElementSpec *es,ElementData *ed,NodeSpec **ns
     ,NodeData **nd,double *rdata,int *idata,double **gpost,double **npost)
{
int i486,i487,i493,i561,i563,i615,i616,i617,i618,i619,i620,i621,i622,i631,b607
     ,b840,b909;
i563=idata[ID_Iteration];
v[562]=rdata[RD_SubIterationTolerance];
v[512]=nd[3]->at[1];
v[511]=nd[3]->at[0];
v[510]=nd[2]->at[1];
v[509]=nd[2]->at[0];
v[508]=nd[1]->at[1];
v[507]=nd[1]->at[0];
v[506]=nd[0]->at[1];
v[505]=nd[0]->at[0];
v[504]=nd[3]->X[1];
v[503]=nd[3]->X[0];
v[502]=nd[2]->X[1];
v[997]=v[502]-v[504];
v[501]=nd[2]->X[0];
v[999]=v[501]-v[503];
v[500]=nd[1]->X[1];
v[993]=v[500]-v[502];
v[499]=nd[1]->X[0];
v[995]=v[499]-v[501];
v[498]=nd[0]->X[1];
v[996]=v[498]-v[500];
v[992]=v[498]-v[504];
v[497]=nd[0]->X[0];
v[998]=v[497]-v[499];
v[994]=v[497]-v[503];
v[491]=es->Data[3];
v[991]=v[491]/2e0;
v[490]=es->Data[2];
v[489]=es->Data[1];
v[588]=es->Data[0]/(2e0*(1e0+v[489]));
v[971]=2e0*v[588];
v[586]=(v[489]*v[971])/(1e0-2e0*v[489]);
i486=es->id.NoIntPoints;
for(i487=1;i487<=i486;i487++){
 i493=4*(-1+i487);
 v[492]=es->IntPoints[i493];
 v[524]=(-1e0+v[492])/4e0;
 v[525]=(-1e0-v[492])/4e0;
 v[530]=v[524]*v[992]+v[525]*v[993];
 v[528]=v[524]*v[994]+v[525]*v[995];
 v[494]=es->IntPoints[1+i493];
 v[526]=(1e0+v[494])/4e0;
 v[523]=(-1e0+v[494])/4e0;
 v[529]=v[523]*v[996]+v[526]*v[997];
 v[527]=v[523]*v[998]+v[526]*v[999];
 v[531]=-(v[528]*v[529])+v[527]*v[530];
 v[534]=-(v[530]/v[531]);
 v[548]=-(v[526]*v[534]);
 v[540]=-(v[523]*v[534]);
 v[535]=v[528]/v[531];
 v[551]=-(v[526]*v[535]);
 v[542]=-(v[523]*v[535]);
 v[536]=-(v[529]/v[531]);
 v[549]=v[524]*v[536];
 v[544]=v[525]*v[536];
 v[537]=v[527]/v[531];
 v[552]=v[524]*v[537];
 v[546]=v[525]*v[537];
 v[538]=v[540]+v[549];
 v[539]=v[542]+v[552];
 v[541]=-v[540]+v[544];
 v[543]=-v[542]+v[546];
 v[545]=-v[544]+v[548];
 v[547]=-v[546]+v[551];
 v[550]=-v[548]-v[549];
 v[553]=-v[551]-v[552];
 v[558]=v[505]*v[538]+v[507]*v[541]+v[509]*v[545]+v[511]*v[550];
 v[559]=(v[506]*v[538]+v[505]*v[539]+v[508]*v[541]+v[507]*v[543]+v[510]*v[545]+v[509]*v[547]
  +v[512]*v[550]+v[511]*v[553])/2e0;
 v[560]=v[506]*v[539]+v[508]*v[543]+v[510]*v[547]+v[512]*v[553];
 i561=8*(-1+i487);
 i622=8+i561;
 i621=7+i561;
 i620=6+i561;
 i619=5+i561;
 i618=4+i561;
 i617=3+i561;
 i616=2+i561;
 i615=1+i561;
 v[571]=ed->hp[i615-1];
 v[572]=ed->hp[i616-1];
 v[573]=ed->hp[i617-1];
 v[574]=ed->hp[i618-1];
 v[575]=ed->hp[i619-1];
 v[576]=ed->hp[i620-1];
 v[577]=ed->hp[i621-1];
 v[583]=v[558]-v[571];
 v[585]=v[560]-v[572];
 v[593]=(v[583]+v[585])*v[586];
 v[595]=v[593]+v[583]*v[971];
 v[597]=v[593]+v[585]*v[971];
 v[604]=(-v[595]-v[597])/3e0;
 if((i563==1 && ed->hp[i622-1]==0e0) || (i563>1 && (-v[490]+sqrt(0.15e1*(Power(v[491]*v[574]+v[595]
  +v[604],2)+Power(v[491]*v[575]+v[597]+v[604],2)+2e0*Power(v[491]*v[576]+(v[559]-v[573])*v[971],2))
  ))<v[562])){
  v[608]=v[571];
  v[609]=v[572];
  v[610]=v[573];
  v[611]=v[574];
  v[612]=v[575];
  v[613]=v[576];
  v[614]=v[577];
  ed->ht[i615-1]=v[608];
  ed->ht[i616-1]=v[609];
  ed->ht[i617-1]=v[610];
  ed->ht[i618-1]=v[611];
  ed->ht[i619-1]=v[612];
  ed->ht[i620-1]=v[613];
  ed->ht[i621-1]=v[614];
  ed->ht[i622-1]=0e0;
 } else {
  v[677]=2e0*v[491];
  v[679]=-v[586]-v[971];
  v[681]=(v[586]-v[679])/3e0;
  v[683]=v[679]+v[681];
  v[682]=-v[586]+v[681];
  v[844]=(2e0/3e0)*(2e0*v[682]-v[683]);
  v[843]=(-2e0/3e0)*(v[682]-2e0*v[683]);
  v[624]=v[571];
  v[625]=v[572];
  v[626]=v[573];
  v[627]=v[574];
  v[628]=v[575];
  v[629]=v[576];
  v[630]=v[577];
  for(i631=1;i631<=30;i631++){
   v[670]=-v[577]+v[630];
   v[974]=-0.5e0*v[670];
   v[635]=v[558]-v[624];
   v[637]=v[560]-v[625];
   v[644]=v[586]*(v[635]+v[637]);
   v[646]=v[644]+v[635]*v[971];
   v[648]=v[644]+v[637]*v[971];
   v[662]=v[491]*v[629]+(v[559]-v[626])*v[971];
   v[689]=(v[662]*v[662]);
   v[655]=(-v[646]-v[648])/3e0;
   v[659]=v[491]*v[628]+v[648]+v[655];
   v[989]=0.15e1*v[659];
   v[988]=v[670]*v[989];
   v[658]=v[491]*v[627]+v[646]+v[655];
   v[987]=-0.15e1*v[658];
   v[740]=(2e0/3e0)*(2e0*v[658]-v[659]);
   v[979]=0.75e0*v[740];
   v[977]=-(v[670]*v[979]);
   v[725]=(-2e0/3e0)*(v[658]-2e0*v[659]);
   v[981]=0.75e0*v[725];
   v[982]=-(v[670]*v[981]);
   v[699]=2e0*(v[658]*v[682]+v[659]*v[683]);
   v[696]=2e0*(v[659]*v[682]+v[658]*v[683]);
   v[685]=(v[658]*v[658])+(v[659]*v[659])+2e0*v[689];
   v[990]=sqrt(0.15e1*v[685]);
   v[976]=3e0/v[990];
   v[972]=-(1e0/(v[685]*v[990]));
   v[703]=v[491]*v[972];
   v[704]=v[659]*v[703];
   v[702]=v[658]*v[703];
   v[698]=v[972]/2e0;
   v[700]=v[698]*v[699];
   v[986]=-0.15e1*v[700];
   v[697]=v[696]*v[698];
   v[984]=0.15e1*v[697];
   v[973]=v[974]*(6e0*v[689]*v[972]+v[976]);
   v[737]=v[491]*v[973];
   v[687]=0.15e1*v[662]*v[972];
   v[975]=v[677]*v[687];
   v[693]=v[659]*v[975];
   v[692]=v[658]*v[975];
   v[667]=v[662]*v[976];
   v[705]=((-2e0/3e0)*v[667])/v[685];
   v[706]=v[491]*v[705];
   v[755]=v[706]*v[977];
   v[701]=-(v[705]*v[971]);
   v[752]=v[701]*v[977];
   v[980]=0.75e0/v[990];
   v[978]=-0.15e1/v[990];
   v[717]=v[491]*v[978];
   v[714]=v[682]*v[978];
   v[712]=v[683]*v[978];
   v[668]=v[659]*v[978];
   v[666]=v[658]*v[978];
   v[747]=-(v[991]/v[990]);
   v[754]=-(v[670]*(v[747]+v[704]*v[979]));
   v[745]=-2e0*v[747];
   v[753]=-(v[670]*(v[745]+v[702]*v[979]));
   v[742]=v[844]*v[980];
   v[751]=-(v[670]*(v[742]+v[700]*v[979]));
   v[739]=v[843]*v[980];
   v[750]=1e0-v[670]*(v[739]+v[697]*v[979]);
   v[985]=v[696]/v[750];
   v[983]=-(v[670]/v[750]);
   v[664]=v[725]*v[980];
   v[738]=-0.5e0*v[667];
   v[675]=v[670]*v[738];
   v[660]=v[740]*v[980];
   v[669]=-v[571]+v[624]-v[660]*v[670];
   v[775]=(v[742]+v[697]*v[981])*v[983];
   v[776]=1e0-v[751]*v[775]-v[670]*(v[739]+v[700]*v[981]);
   v[777]=-(v[752]*v[775])+v[701]*v[982];
   v[778]=-(v[753]*v[775])-v[670]*(v[747]+v[702]*v[981]);
   v[779]=-(v[754]*v[775])-v[670]*(v[745]+v[704]*v[981]);
   v[780]=-(v[755]*v[775])+v[706]*v[982];
   v[781]=-v[664]+v[660]*v[775];
   v[782]=v[687]*v[974]*v[985];
   v[827]=v[669]*v[782];
   v[823]=v[660]*v[782];
   v[820]=-(v[755]*v[782]);
   v[783]=v[983]*(v[712]-v[658]*v[984]);
   v[784]=-(v[983]*(-v[714]+v[659]*v[984]));
   v[785]=v[980]*v[985];
   v[786]=v[572]-v[625]+v[664]*v[670]+v[669]*v[775];
   v[787]=-0.5e0*(v[670]*v[687]*v[699]+2e0*v[751]*v[782])/v[776];
   v[828]=-(v[786]*v[787]);
   v[824]=-(v[781]*v[787]);
   v[821]=-(v[780]*v[787]);
   v[788]=1e0-v[752]*v[782]-v[777]*v[787]-v[971]*v[973];
   v[789]=-(v[753]*v[782])-v[778]*v[787]+v[692]*v[974];
   v[790]=-(v[754]*v[782])-v[779]*v[787]+v[693]*v[974];
   v[791]=v[737]+v[820]+v[821];
   v[792]=v[738]+v[823]+v[824];
   v[793]=-((v[751]*v[783]+v[670]*(v[714]+v[658]*v[986]))/v[776]);
   v[794]=-((v[751]*v[784]+v[670]*(v[712]+v[659]*v[986]))/v[776]);
   v[795]=(-(v[751]*v[785])+v[699]*v[980])/v[776];
   v[796]=v[573]-v[626]-v[675]+v[827]+v[828];
   v[797]=-((v[752]*v[783]+v[777]*v[793]+v[670]*v[701]*v[987])/v[788]);
   v[798]=1e0-v[753]*v[783]-v[778]*v[793]-v[789]*v[797]-v[670]*(v[717]+v[702]*v[987]);
   v[799]=-(v[754]*v[783])-v[779]*v[793]-v[790]*v[797]+v[702]*v[988];
   v[800]=v[670]*v[692]-v[755]*v[783]-v[780]*v[793]-v[791]*v[797];
   v[801]=-v[666]+v[660]*v[783]-v[781]*v[793]-v[792]*v[797];
   v[802]=-((v[752]*v[784]+v[777]*v[794]-v[701]*v[988])/v[788]);
   v[805]=-((-1e0+v[788])/v[788]);
   v[806]=(-(v[752]*v[785])-v[777]*v[795]-v[667]*v[971])/v[788];
   v[807]=v[574]-v[627]+v[666]*v[670]+v[669]*v[783]-v[786]*v[793]-v[796]*v[797];
   v[808]=v[799]/v[798];
   v[809]=1e0-v[754]*v[784]-v[779]*v[794]-v[790]*v[802]-v[799]*v[808]-v[670]*(v[717]-v[704]*v[989]
    );
   v[810]=v[670]*v[693]-v[755]*v[784]-v[780]*v[794]-v[791]*v[802]-v[800]*v[808];
   v[811]=-v[668]+v[660]*v[784]-v[781]*v[794]-v[792]*v[802]-v[801]*v[808];
   v[814]=-((v[789]+v[789]*v[805])/v[798]);
   v[815]=-((v[658]*v[717]+v[753]*v[785]+v[778]*v[795]+v[789]*v[806])/v[798]);
   v[816]=v[575]-v[628]+v[668]*v[670]+v[669]*v[784]-v[786]*v[794]-v[796]*v[802]-v[807]*v[808];
   v[819]=-((v[790]+v[790]*v[805]+v[799]*v[814])/v[809]);
   v[822]=1e0-v[737]-v[791]*v[805]-v[800]*v[814]-v[810]*v[819]-v[820]-v[821];
   v[825]=-v[738]-v[792]*v[805]-v[801]*v[814]-v[811]*v[819]-v[823]-v[824];
   v[826]=-((v[659]*v[717]+v[754]*v[785]+v[779]*v[795]+v[790]*v[806]+v[799]*v[815])/v[809]);
   v[829]=v[576]-v[629]+v[675]-v[796]*v[805]-v[807]*v[814]-v[816]*v[819]-v[827]-v[828];
   v[830]=-((-(v[491]*v[667])+v[755]*v[785]+v[780]*v[795]+v[791]*v[806]+v[800]*v[815]+v[810]*v[826]
    )/v[822]);
   v[832]=-((v[490]+v[669]*v[785]-v[786]*v[795]-v[796]*v[806]-v[807]*v[815]-v[816]*v[826]
    -v[829]*v[830]-v[990])/(-(v[660]*v[785])+v[781]*v[795]+v[792]*v[806]+v[801]*v[815]+v[811]*v[826]
    +v[825]*v[830]));
   v[833]=(v[829]-v[825]*v[832])/v[822];
   v[834]=(v[816]-v[811]*v[832]-v[810]*v[833])/v[809];
   v[835]=-((-v[807]+v[801]*v[832]+v[800]*v[833]+v[799]*v[834])/v[798]);
   v[836]=-((-v[796]+v[792]*v[832]+v[791]*v[833]+v[790]*v[834]+v[789]*v[835])/v[788]);
   v[837]=-((-v[786]+v[781]*v[832]+v[780]*v[833]+v[779]*v[834]+v[778]*v[835]+v[777]*v[836])/v[776]
    );
   v[838]=-((v[669]-v[660]*v[832]+v[755]*v[833]+v[754]*v[834]+v[753]*v[835]+v[752]*v[836]
    +v[751]*v[837])/v[750]);
   v[624]=v[624]+v[838];
   v[625]=v[625]+v[837];
   v[626]=v[626]+v[836];
   v[627]=v[627]+v[835];
   v[628]=v[628]+v[834];
   v[629]=v[629]+v[833];
   v[630]=v[630]+v[832];
   if(sqrt((v[832]*v[832])+(v[833]*v[833])+(v[834]*v[834])+(v[835]*v[835])+(v[836]*v[836])+
    (v[837]*v[837])+(v[838]*v[838]))<v[562]){
    ed->ht[i615-1]=v[624];
    ed->ht[i616-1]=v[625];
    ed->ht[i617-1]=v[626];
    ed->ht[i618-1]=v[627];
    ed->ht[i619-1]=v[628];
    ed->ht[i620-1]=v[629];
    ed->ht[i621-1]=v[630];
    ed->ht[i622-1]=1e0;
    break;
   } else {
   };
   if(i631==29){
    idata[ID_SubDivergence]=1e0;
    idata[ID_ErrorStatus]=2e0;
    break;
   } else {
   };
  };/* end for */
  v[608]=v[624];
  v[609]=v[625];
  v[610]=v[626];
  v[611]=v[627];
  v[612]=v[628];
  v[613]=v[629];
  v[614]=v[630];
 };
 v[915]=v[558]-v[608];
 v[916]=v[559]-v[610];
 v[917]=v[560]-v[609];
 v[924]=v[915]+v[917];
 v[927]=v[586]*v[924];
 v[928]=v[927]+v[917]*v[971];
 v[925]=v[927]+v[915]*v[971];
 v[931]=(-v[925]-v[928])/3e0;
 v[929]=v[916]*v[971];
 gpost[i487-1][0]=v[558];
 gpost[i487-1][1]=v[559];
 gpost[i487-1][2]=v[560];
 gpost[i487-1][3]=v[915];
 gpost[i487-1][4]=v[916];
 gpost[i487-1][5]=v[917];
 gpost[i487-1][6]=v[558]-v[915];
 gpost[i487-1][7]=v[559]-v[916];
 gpost[i487-1][8]=v[560]-v[917];
 gpost[i487-1][9]=v[925];
 gpost[i487-1][10]=v[929];
 gpost[i487-1][11]=v[928];
 gpost[i487-1][12]=sqrt(0.15e1*(2e0*(v[929]*v[929])+Power(v[925]+v[931],2)+Power(v[928]+v[931],2))
  );
 gpost[i487-1][13]=v[611];
 gpost[i487-1][13]=v[613];
 gpost[i487-1][13]=v[613];
 gpost[i487-1][13]=v[612];
 gpost[i487-1][14]=v[614];
 gpost[i487-1][15]=v[588]*((v[915]*v[915])+2e0*(v[916]*v[916])+(v[917]*v[917]))+(v[586]*
  (v[924]*v[924]))/2e0+((v[611]*v[611])+(v[612]*v[612])+2e0*(v[613]*v[613]))*v[991];
};/* end for */
npost[0][0]=v[505];
npost[1][0]=v[507];
npost[2][0]=v[509];
npost[3][0]=v[511];
npost[0][1]=v[506];
npost[1][1]=v[508];
npost[2][1]=v[510];
npost[3][1]=v[512];
npost[0][2]=v[505];
npost[1][2]=v[507];
npost[2][2]=v[509];
npost[3][2]=v[511];
npost[0][3]=v[506];
npost[1][3]=v[508];
npost[2][3]=v[510];
npost[3][3]=v[512];
};
